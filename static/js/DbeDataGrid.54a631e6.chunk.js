"use strict";(self.webpackChunkroot1=self.webpackChunkroot1||[]).push([[589],{50030:function(e,t,n){n.r(t),n.d(t,{default:function(){return B}});var o=n(1413),a=n(70885),r=n(72791),i=n(50649),l=n.n(i),s=n(98482),u=n(56118),c=n(55841),d=n(59595),f=n(74165),m=n(15861),p=n(48573),b=n.n(p),g=function(e){return(0,r.useMemo)((function(){return b()((function(t){var n=t.component;(0,m.Z)((0,f.Z)().mark((function t(){var o,a;return(0,f.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.getTableDataModel().hasSummary()){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,n.getSelectedRowsData();case 4:o=t.sent,a=e.getTableDataModel().createFilterGroupFromUniqueKeys(o),e.getTableDataModel().setSelectionFilter(a.isZeroFilter()?null:a),n.refresh(!0);case 8:case"end":return t.stop()}}),t)})))()}),1e3)}),[e])},h=n(40129),E=n(80496),C=function(e,t,n,o,a){var i=(0,r.useMemo)((function(){return new E.Z}),[]),l=g(e),s=(0,r.useMemo)((function(){return a?{height:a}:{}}),[a]);return(0,r.useEffect)((function(){e&&e.setTableRef(t)}),[e,t,t.current]),(0,r.useEffect)((function(){o&&e&&n.setToolbarInstance(e.table.getTableName(),o)}),[o,o.current,e]),(0,r.useEffect)((function(){var t;e&&e.canExecuteUpdateTable()&&e.toolbarPanelButtonManager&&i.createNotification({message:(0,u.Z)("_RECALCULATE_REPORT_DATA"),type:h.z.INFO,clickHandler:null===e||void 0===e||null===(t=e.toolbarPanelButtonManager)||void 0===t?void 0:t.toolbarPanelButtonEvents.recalculateReportDataClickHandler()})}),[e]),{debouncedRefresh:l,additionalProps:s}},v=n(45217),_=n(73283),T=n.n(_),I=n(52614),R=n(60545),S=n(3901),F=n(74769),w=n(19342),Z=n(90894),x=function(e,t){var n=(0,w.default)().openModalWithProps,o=(0,r.useState)(0),i=(0,a.Z)(o,2),l=i[0],s=i[1],c=(0,r.useState)(0),d=(0,a.Z)(c,2),p=d[0],b=d[1],g=(0,r.useState)(new I.e_),h=(0,a.Z)(g,2),E=h[0],C=h[1],v=(0,r.useState)(new I.e_),_=(0,a.Z)(v,2),T=_[0],x=_[1],A=(0,r.useState)(!1),L=(0,a.Z)(A,2),M=L[0],D=L[1],N=(0,r.useState)([]),y=(0,a.Z)(N,2),j=y[0],O=y[1];(0,r.useEffect)((function(){e&&e.getTableDataModel().setRefreshCounter((function(e){var t=e.totalCount;s(t)}))}),[e]),(0,r.useEffect)((function(){D(e.checkIfColumnsFiltered()),t.current.instance.on("selectionChanged",function(){var t=(0,m.Z)((0,f.Z)().mark((function t(n){var o,a,r;return(0,f.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.component,t.next=3,o.getSelectedRowsData();case 3:a=t.sent,r=e.getTableDataModel().createFilterGroupFromUniqueKeys(a),b(a.length),C(r);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.current.instance.on("optionChanged",function(){var t=(0,m.Z)((0,f.Z)().mark((function t(n){return(0,f.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("columns"===n.name){t.next=2;break}return t.abrupt("return");case 2:setTimeout((function(){var t=e.getTableDataModel().getRowAndHeaderFilter();D(t&&!t.isZeroFilter()),x(t)}),800);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),[t]);var B=(0,r.useCallback)((function(){var t;return(t=e.toolbarPanelButtonManager).dispatchForToolbar.apply(t,arguments)}),[e,e.toolbarPanelButtonManager]);(0,r.useEffect)((function(){t.current.instance.on("optionChanged",(function(e){var t=Z.Z.parseSettingFullName(e.fullName),n=(0,a.Z)(t,2),o=(n[0],n[1]);if("visible"===o){var r=e.component.getView("columnChooserView"),i=r.getColumns().map((function(e){return e.dataField}));r.isColumnChooserVisible()&&O(i),B({type:"UPDATE_SELECTED_ITEM_KEY",payload:{selectedItemKey:null,buttonName:F.Z.hiddenColumnSettingButton}})}"sortOrder"===o&&B({type:"UPDATE_SELECTED_ITEM_KEY",payload:{selectedItemKey:null,buttonName:F.Z.tableSortButton}})})),t.current.instance.on("contentReady",(function(t){var n=t.component.getView("columnChooserView"),o=n.getColumns().map((function(e){return e.dataField}));n.isColumnChooserVisible()&&O(o),e.setColumnChooserRef(n),n._popupContainer||(n._initializePopupContainer(),n.render(),n._popupContainer.on("hiding",(function(){O([])})),n._popupContainer.on("showing",(function(){var e=n.getColumns().map((function(e){return e.dataField}));O(e)})))}))}),[t]);var k=(0,r.useCallback)((function(){var o;n(R.Z.SELECTION_FOR_FILTER_MODAL,{tableInstance:e,type:S.h.FILTER_SETTINGS,modalTitle:(0,u.Z)("_SAVE_SELECTION_FOR_FILTER_AS"),setting:E,dataGrid:null===t||void 0===t||null===(o=t.current)||void 0===o?void 0:o.instance})}),[E]),P=(0,r.useCallback)((function(){var o;n(R.Z.SELECTION_FOR_FILTER_MODAL,{tableInstance:e,type:S.h.FILTER_SETTINGS,modalTitle:(0,u.Z)("_SAVE_QUICK_FILTER_AS"),setting:T,dataGrid:null===t||void 0===t||null===(o=t.current)||void 0===o?void 0:o.instance})}),[T]),G=(0,r.useCallback)((function(){var o;n(R.Z.SELECTION_FOR_FILTER_MODAL,{tableInstance:e,type:S.h.HIDDEN_COLUMNS_SETTING,modalTitle:(0,u.Z)("_SAVE_HIDDEN_COLUMNS_FILTER_AS"),setting:j,dataGrid:null===t||void 0===t||null===(o=t.current)||void 0===o?void 0:o.instance})}),[j]);return{allRowsCount:l,selectedRowsCount:p,selectionFilter:E,createSelectionFilter:k,createRowAndHeaderFilter:P,isHeaderAndRowFilterButtonVisible:M,createHiddenColumnFilter:G,hiddenColumnFilter:j}},A=n(80184),L=function(e){var t=e.tableInstance,n=e.dbeDxGridRef,o=x(t,n),a=o.allRowsCount,r=o.selectedRowsCount,i=o.selectionFilter,l=o.createSelectionFilter,s=o.createRowAndHeaderFilter,c=o.isHeaderAndRowFilterButtonVisible,d=o.createHiddenColumnFilter,f=o.hiddenColumnFilter;return(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)(T(),{className:"footer-holder",children:[(0,A.jsx)(_.Item,{visible:!i.isZeroFilter(),widget:"dxButton",options:{type:"success",text:(0,u.Z)("_SAVE_SELECTION_FOR_FILTER_AS"),onClick:l},location:"before",locateInMenu:"auto"},"selectionFilter"),(0,A.jsx)(_.Item,{visible:c,widget:"dxButton",options:{type:"success",text:(0,u.Z)("_SAVE_QUICK_FILTER_AS"),onClick:s},location:"before",locateInMenu:"auto"},"rowAndHeaderFilter"),(0,A.jsx)(_.Item,{visible:f.length,widget:"dxButton",options:{type:"success",text:(0,u.Z)("_SAVE_HIDDEN_COLUMNS_FILTER_AS"),onClick:d},location:"before",locateInMenu:"auto"},"hiddenColumnFilter"),(0,A.jsx)(_.Item,{location:"after",locateInMenu:"auto",html:"<div>\n                    <span>".concat((0,u.Z)("SELECTED_ROWS"),":</span>\n                    <span><b>").concat(r,"</b></span>\n                </div>")},"selectedRows"),(0,A.jsx)(_.Item,{location:"after",locateInMenu:"auto",html:"<div>\n                    <span>".concat((0,u.Z)("ALL_ROWS"),":</span>\n                    <span><b>").concat(a,"</b></span>\n                </div>")},"allRows")]})})},M=n(68418),D=n(29814),N=n(78805),y=n(3016),j=(n(28871),(0,r.lazy)((function(){return Promise.resolve().then(n.bind(n,6977))}))),O=function(e){var t=e.tableName,n=e.height,f=e.isScreenBuilderTable,m=e.tableType,p=e.initialFilter,b=e.saveButtonVisibility,g=(0,r.useRef)(),h=(0,r.useRef)(),E=(0,s.T1)(t),_=E.tableInstance,T=E.tableInstanceManager,I=(0,s.CY)(_,g,t,m,p,T),R=(0,a.Z)(I,3),S=R[0],F=R[1],w=R[2],Z=C(_,g,T,h,n),x=Z.debouncedRefresh,O=Z.additionalProps,B=(0,s.H3)(_);console.log("tableInstance",_),console.log("dbeDxGridRef",g);var k=(0,r.useMemo)((function(){return new N.Z({store:new D.Z({key:"ID_station",data:(0,y.Z)()})})}),[]);return _&&null!==n?(0,A.jsxs)(r.Fragment,{children:[(0,A.jsx)(v.Z,{tableType:f?c.Z.SCREEN_BUILDER_TABLE:m,tableInstance:_,dbeDxGridRef:g,toolbarRef:h,saveButtonVisibility:b}),(0,A.jsxs)(l(),(0,o.Z)((0,o.Z)({width:"100%",ref:g,dataSource:k,hoverStateEnabled:!0,allowColumnReordering:!0,allowColumnResizing:!0,columnResizingMode:"widget",cellHintEnabled:!0,showColumnHeaders:!0,remoteOperations:!0,highlightChanges:!0,repaintChangesOnly:!0,cacheEnabled:!1,rowAlternationEnabled:!0,showRowLines:!0,showBorders:!0,customizeColumns:S,onInitialized:w,onOptionChanged:F,onSelectionChanged:function(e){return x(e)},onCellPrepared:B},O),{},{children:[(0,A.jsx)(i.ColumnFixing,{enabled:!0}),(0,A.jsx)(i.Editing,{mode:"cell",allowUpdating:_.isTableEditable,refreshMode:"repaint",startEditAction:"dblClick"}),(0,A.jsx)(i.Selection,{mode:t===c.Z.ORIGINAL_TABLE?"multiple":"single",deferred:!1,showCheckBoxesMode:"none"}),(0,A.jsx)(i.FilterRow,{visible:!0}),(0,A.jsx)(i.HeaderFilter,{visible:!0}),(0,A.jsx)(i.Scrolling,{mode:"virtual",rowRenderingMode:"virtual"}),(0,A.jsx)(i.Sorting,{mode:"multiple"}),(0,A.jsx)(i.Paging,{pageSize:_.pageSize||300}),(0,A.jsx)(i.Pager,{visible:!0,displayMode:"full",showPageSizeSelector:!0,showInfo:!1,showNavigationButtons:!0}),_.getTableDataModel().columns.map((function(e){return(0,A.jsx)(i.Column,(0,o.Z)((0,o.Z)({},e.getColumnParameters()),{},{children:e.getChildren()}))})),(0,A.jsx)(i.Summary,{children:_.getTableDataModel().columns.reduce((function(e,t){return t.getFooterAction()&&e.push((0,A.jsx)(i.TotalItem,{column:t.getName(),summaryType:t.getFooterAction(),customizeText:function(e){var t=e.value;return(0,M.$K)(t)?Number(t).toFixed(3):"-"}},t.getName())),e}),[])}),(0,A.jsx)(i.MasterDetail,{enabled:!0,component:function(e){var t=e.data;return(0,A.jsx)(r.Suspense,{fallback:(0,A.jsx)("div",{children:(0,A.jsx)(d.Z,{})}),children:(0,A.jsx)(j,(0,o.Z)((0,o.Z)({},t),{},{dbeDxGridRef:g,tableInstance:_,id:"detail-row-view"}))})}})]}),"".concat(t,"-dataGrid")),(0,A.jsx)(L,{tableInstance:_,dbeDxGridRef:g})]}):(0,A.jsx)(d.Z,{message:"".concat((0,u.Z)("TABLE_LOADING")," ...")})};O.defaultProps={tableName:c.Z.ORIGINAL_TABLE,tableType:c.Z.ORIGINAL_TABLE,isScreenBuilderTable:!1,height:void 0};var B=O}}]);
//# sourceMappingURL=DbeDataGrid.54a631e6.chunk.js.map