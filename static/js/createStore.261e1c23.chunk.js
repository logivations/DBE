"use strict";(self.webpackChunkroot1=self.webpackChunkroot1||[]).push([[204],{60430:function(t,e,n){n.r(e),n.d(e,{default:function(){return v}});var r=n(42982),o=n(15671),a=n(43144),i=n(3166),l=n(52449),s=n(29461),u=n(52614);function d(t,e,n){(e=function(t){if(Array.isArray(t)||"object"===typeof t)return{data:t};if("number"===typeof t)return{totalCount:t};return t}(e))&&"object"===typeof e?t.resolve.apply(t,n(e)):t.reject(new Error("Unexpected response received"))}function c(t){return{totalCount:"totalCount"in t?t.totalCount:-1,groupCount:"groupCount"in t?t.groupCount:-1,summary:t.summary||null}}function f(t){return"object"===typeof t?JSON.stringify(t):t}function h(t){t.forEach((function(e,n){Array.isArray(e)?h(e):"[object Date]"===Object.prototype.toString.call(e)&&(t[n]=function(t){function e(t,e){for(t=String(t);t.length<e;)t="0".concat(t);return t}var n=[1+t.getMonth(),"/",t.getDate(),"/",t.getFullYear()],r=t.getHours(),o=t.getMinutes(),a=t.getSeconds(),i=t.getMilliseconds();return r+o+a+i>0&&n.push(" ",e(r,2),":",e(o,2),":",e(a,2),".",e(i,3)),n.join("")}(e))}))}function p(t){var e=t.getResponseHeader("Content-Type"),n=t.responseText;if(!e)return null;if(0===e.indexOf("text/plain"))return n;if(0===e.indexOf("application/json")){var r=function(t){try{return JSON.parse(t)}catch(e){return null}}(n);if("string"===typeof r)return r;if("object"===typeof r)for(var o in r)if("string"===typeof r[o])return r[o];return n}return null}var y=n(24881),m=["onLoading","onLoaded","onInserting","onInserted","onUpdating","onUpdated","onRemoving","onRemoved","onModifying","onModified","onPush","loadMode","cacheRawData","errorHandler"],g=function(){function t(e){(0,o.Z)(this,t),this.keyExpr=null,this.loadUrl="",this.totalCountUrl="",this.loadMethod="",this.updateMethod="",this.insertMethod="",this.deleteMethod="",this.totalCountMethod="",this.loadParams=null,this.isRawLoadMode=!1,this.updateUrl="",this.insertUrl="",this.deleteUrl="",this.onBeforeSend=null,this.onAjaxError=null,this.options={},this.tableDataModel=null,this.loadDataTransformer=void 0,this.handleInsertUpdateSuccess=function(t,e,n){var r=n.getResponseHeader("Content-Type"),o=r&&r.includes("application/json");t.resolve(o?JSON.parse(e):e)},this.keyExpr=e.key,this.loadUrl=e.loadUrl,this.loadMethod=e.loadMethod||"GET",this.updateMethod=e.updateMethod||"PUT",this.insertMethod=e.insertMethod||"POST",this.deleteMethod=e.deleteMethod||"DELETE",this.totalCountMethod=e.deleteMethod||"POST",this.loadParams=e.loadParams,this.isRawLoadMode="raw"===e.loadMode,this.updateUrl=e.updateUrl,this.insertUrl=e.insertUrl,this.deleteUrl=e.deleteUrl,this.totalCountUrl=e.totalCountUrl,this.onBeforeSend=e.onBeforeSend,this.onAjaxError=e.onAjaxError,this.options=e,this.tableDataModel=e.tableDataModel,this.loadDataTransformer=e.loadDataTransformer||function(t){return t}}return(0,a.Z)(t,[{key:"send",value:function(t,e,r,o){var a,l,s=this,u=(0,i.BH)(),d=function(){Promise.resolve().then(n.bind(n,54882)).then((function(t){var e=t.default;return y.Z.getTokens().then((function(){e.sendRequest(r).then((function(t,e,n){o?o(u,t,n):u.resolve()}),(function(t,e){var n=p(t);if(s.onAjaxError){var r={xhr:t,error:n};s.onAjaxError(r),n=r.error}n?u.reject(n):u.reject(t,e)}))}))}))};return e&&!this.keyExpr?u.reject(new Error("Primary key is not specified (operation: '".concat(t,"', url: '").concat(r.url,"')"))):(r.cache=!1,r.dataType="json",this.onBeforeSend&&(l=this.onBeforeSend(t,r))&&"function"===typeof l.then&&(a=l),a?a.then(d,(function(t){u.reject(t)})):d()),u.promise()}},{key:"filterByKey",value:function(t){return Array.isArray(this.keyExpr)?this.keyExpr.map((function(e){return[e,t[e]]})):[this.keyExpr,t]}},{key:"loadOptionsToActionParams",value:function(t,e){var n={};if(Object.assign(t,{isDictinct:!!t.dataField}),e&&(n.isCountQuery=e),t){["skip","take","requireTotalCount","requireGroupCount","isDictinct"].forEach((function(e){void 0!==t[e]&&(n[e]=t[e])})),n.dataField=Object.hasOwn(t,"dataField")?[t.dataField]:[];var r,o=s.G5,a=t.group,i=t.filter,d=t.select,c=t.sort,f=t.totalSummary;if(c&&(n.sort=u.jQ.create(o(t.sort))),a&&(function(t){if(!Array.isArray(t))return!1;for(var e=0;e<t.length;e++)if("groupInterval"in t[e]||"isExpanded"in t[e])return!0;return!1}(a)||(a=o(a)),a.forEach((function(t){var e=t.selector;n.dataField.includes(e)||(n.dataField.push(e),n.isDictinct=!0)}))),i)i.setting instanceof u.e_?r=i.setting:i instanceof u.e_?r=i:(h(i=(0,l.l)(!0,[],i)),r=u.e_.createFilterGroup(i),this.tableDataModel.setRowAndHeaderFilter(r)),this.tableDataModel.setAllAppliedFilters(r),n.filter=r;else this.tableDataModel.setAllAppliedFilters(null),this.tableDataModel.setRowAndHeaderFilter(null);f&&(n.totalSummary=f.filter((function(t){return"NULL"!==t.summaryType})),n.selectionFilter=this.tableDataModel.getSelectionFilter()),t.groupSummary&&(n.groupSummary=t.groupSummary),d&&(Array.isArray(d)||(d=[d]),n.select=d)}return(0,l.l)(n,this.loadParams),JSON.stringify(n)}},{key:"createResult",value:function(){var t=this,e={key:this.keyExpr,useDefaultSearch:!0,load:function(e){return t.send("load",!1,{url:t.loadUrl,method:t.loadMethod,data:t.loadOptionsToActionParams(e,!1),headers:{"Content-Type":"application/json"}},(function(n,o){d(n,o,(function(n){var o;if(e.dataField||null!==(o=e.group)&&void 0!==o&&o.length)try{return[n.data.data.reduce((function(t,e){return[].concat((0,r.Z)(t),(0,r.Z)(Object.values(e).map((function(t){return{key:t,items:null,count:n.length}}))))}),[]),c(n)]}catch(a){console.error("ProcessLoadResponse Error: ",a)}return[t.loadDataTransformer(n.data),c(n)]}))}))},totalCount:function(e){!t.isRawLoadMode&&t.send("send",!1,{url:t.totalCountUrl,method:t.totalCountMethod,data:t.loadOptionsToActionParams(e,!0),headers:{"Content-Type":"application/json"}},(function(t,e){d(t,e,(function(t){return[t.totalCount]}))}))},byKey:function(e){!t.isRawLoadMode&&t.send("load",!0,{url:t.loadUrl,method:t.loadMethod,data:t.loadOptionsToActionParams({filter:t.filterByKey(e)},!1)},(function(t,e){d(t,e,(function(t){return[t.data[0]]}))}))},update:function(e,n){return t.send("update",!0,{url:t.updateUrl,method:t.updateMethod,headers:{"Content-Type":"application/json"},data:JSON.stringify(t.tableDataModel.updateOptionsToActionParams(e,n))},(function(t,e,n){var r=n.getResponseHeader("Content-Type"),o=r&&r.includes("application/json");t.resolve(o?e.updatedRow:e)}))},insert:function(e){t.insertUrl&&t.send("insert",!0,{url:t.insertUrl,method:t.insertMethod,data:{values:JSON.stringify(e)}},t.handleInsertUpdateSuccess)},remove:function(e){t.deleteUrl&&t.send("delete",!0,{url:t.deleteUrl,method:t.deleteMethod,data:{key:f(e)}},(function(){}))}};return m.forEach((function(n){var r=t.options[n];void 0!==r&&(e[n]=r)})),e}}],[{key:"createStoreConfig",value:function(e){return new t(e).createResult()}}]),t}();function v(t){var e=g.createStoreConfig(t);return Promise.resolve().then(n.bind(n,49050)).then((function(t){return new(0,t.default)(e)}))}}}]);
//# sourceMappingURL=createStore.261e1c23.chunk.js.map